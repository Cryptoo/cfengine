PORTDIR_OVERLAY="/usr/cryptoo /usr/site-local/portage"
[%CFEngine have_layman_conf:: %]
source /$(cryptoo:file_names.overlay_conf)
[%CFEngine any:: %]
PORTDIR_OVERLAY="/usr/local/portage ${PORTDIR_OVERLAY}"

CFLAGS="-O2 -pipe -march=native"
CXXFLAGS="${CFLAGS}"
CHOST="x86_64-pc-linux-gnu"

[%CFEngine local_role_host:: %]
MAKEOPTS="-j8 -l8"

EMERGE_DEFAULT_OPTS="--ask --jobs --load-average 8.0 --keep-going --buildpkg"
[%CFEngine local_role_guest:: %]
MAKEOPTS="-j2 -l1.4"

EMERGE_DEFAULT_OPTS="--ask --jobs --load-average 1.0 --keep-going --usepkgonly --binpkg-respect-use=y"
[%CFEngine any:: %]

#CPU options
$(cryptoo:cryptoo_filesystem.cpu_flags)
USE="${CPU_FLAGS_X86}"

#Local options
USE="${USE} $(cryptoo:cryptoo.site_config[make.conf][USE])"

[%CFEngine local_role_master:: %]
VIDEO_CARDS="$(cryptoo:cryptoo.site_config[make.conf][VIDEO_CARDS])"
[%CFEngine !local_role_master:: %]
VIDEO_CARDS="modesetting"

[%CFEngine local_role_master&nomultilib:: %]
PKGDIR="/usr/site-local/packages/host/no-multilib/${ARCH}"
[%CFEngine local_role_master&multilib:: %]
PKGDIR="/usr/site-local/packages/host/multilib/${ARCH}"
[%CFEngine local_role_server&nomultilib:: %]
PKGDIR="/usr/site-local/packages/server/no-multilib/${ARCH}"
[%CFEngine local_role_server&multilib:: %]
PKGDIR="/usr/site-local/packages/server/multilib/${ARCH}"
[%CFEngine local_role_desktop&nomultilib:: %]
PKGDIR="/usr/site-local/packages/desktop/no-multilib/${ARCH}"
[%CFEngine local_role_desktop&multilib:: %]
PKGDIR="/usr/site-local/packages/desktop/multilib/${ARCH}"
